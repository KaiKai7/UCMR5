<!DOCTYPE html>
<html>
<head>
    <title>PuraView EPA UCMR 5 Search Tool</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>
        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgb(0,0,0);
            background-color: rgba(0,0,0,0.4);
            padding-top: 60px;
        }
        .modal-content {
            background-color: #908d8d;
            margin: 5% auto;
            padding: 20px;
            border: 5px solid #888;
            border-color: #6666a2; /* Change this to your desired color */
            width: 80%;
            border-radius: 10px; /* Add this line to round the corners */
        }
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }
        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
        body {
            transition: background-color 0.3s, color 0.3s;
        }
        body.light-theme {
            background-color: white;
            color: black;
        }
        body.dark-theme {
            background-color: black;
            color: white;
        }
        .question {
            cursor: pointer;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .answer {
            display: none;
            background-color: #8a8787;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin-bottom: 10px;
        }
    </style>
      <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>
<body class="light-theme">

<div style="display: flex; align-items: center;">
    
<a href="https://play.google.com/store/apps/details?id=com.mobile.puraview" target="_blank">
    <img src="https://raw.githubusercontent.com/KaiKai7/PuraView-Overview/main/pviewnobackgroundpng.png" alt="PuraView Logo" style="margin-right: 10px;">
</a>        
        <h2>PuraView UCMR 5 Search</h2>
    </div>

<div>
    <p class="question">What is UCMR 5?</p>
    <div class="answer">
        <p>UCMR 5 stands for the Fifth Unregulated Contaminant Monitoring Rule.</p>
        <p>Every five years, the Environmental Protection Agency (EPA) initiates a program to monitor contaminants that may be present in drinking water.</p>
        <p>UCMR 5 specifically focuses on 30 chemical contaminants, including 29 per- and polyfluoroalkyl substances (PFAS) and lithium.</p>
        <p>The goal is to collect scientifically valid data on the national occurrence of these contaminants in drinking water systems.</p>
        <p>This information helps inform future regulations and actions to protect public health under the Safe Drinking Water Act (SDWA).</p>
    </div>

    <p class="question">What is PFAS?</p>
    <div class="answer">
        <p>PFAS stands for per- and polyfluoroalkyl substances, a group of synthetic chemicals used in various consumer products since the 1950s.</p>
        <p>These chemicals are known for their ability to resist grease, oil, water, and heat.</p>
        <p>PFAS are often referred to as forever chemicals because they break down very slowly in the environment and can accumulate in the human body over time.</p>
        <p>They are found in many everyday items, such as non-stick cookware, water-repellent clothing, stain-resistant fabrics, and firefighting foams.</p>
        <p>Exposure to certain PFAS has been linked to various health issues, including changes in cholesterol levels, developmental effects in children, decreased fertility, and potential impacts on the immune system.</p>
    </div>

    <p class="question">What is this site?</p>
    <div class="answer">
        <p>The data shown on this site originates from the Environmental Protection Agency UCMR 5 database.</p>
        <p>Although the EPA provides a way to view the data, the average user may find it difficult to use the site due to the overwhelming advanced options it provides.</p>
        <p>PuraView UCMR 5 Search Tool makes it easy to search the database as well as view the results.</p>
    </div>
</div>

<br>

<button id="theme-toggle" style="background-color: #242524; color: white; border: none; padding: 5px 9px; text-align: center; text-decoration: none; display: inline-block; font-size: 10px; margin: 4px 2px; cursor: pointer; border-radius: 10px;">Toggle Theme</button><br>

<br>

<label for="state">State</label>
<br>
<select id="state">
    <option value="stateDisabled"></option>
    <option value="AL">Alabama</option>
    <option value="AK">Alaska</option>
    <option value="AZ">Arizona</option>
    <option value="AR">Arkansas</option>
    <option value="CA">California</option>
    <option value="CO">Colorado</option>
    <option value="CT">Connecticut</option>
    <option value="DE">Delaware</option>
    <option value="FL">Florida</option>
    <option value="GA">Georgia</option>
    <option value="HI">Hawaii</option>
    <option value="ID">Idaho</option>
    <option value="IL">Illinois</option>
    <option value="IN">Indiana</option>
    <option value="IA">Iowa</option>
    <option value="KS">Kansas</option>
    <option value="KY">Kentucky</option>
    <option value="LA">Louisiana</option>
    <option value="ME">Maine</option>
    <option value="MD">Maryland</option>
    <option value="MA">Massachusetts</option>
    <option value="MI">Michigan</option>
    <option value="MN">Minnesota</option>
    <option value="MS">Mississippi</option>
    <option value="MO">Missouri</option>
    <option value="MT">Montana</option>
    <option value="NE">Nebraska</option>
    <option value="NV">Nevada</option>
    <option value="NH">New Hampshire</option>
    <option value="NJ">New Jersey</option>
    <option value="NM">New Mexico</option>
    <option value="NY">New York</option>
    <option value="NC">North Carolina</option>
    <option value="ND">North Dakota</option>
    <option value="OH">Ohio</option>
    <option value="OK">Oklahoma</option>
    <option value="OR">Oregon</option>
    <option value="PA">Pennsylvania</option>
    <option value="RI">Rhode Island</option>
    <option value="SC">South Carolina</option>
    <option value="SD">South Dakota</option>
    <option value="TN">Tennessee</option>
    <option value="TX">Texas</option>
    <option value="UT">Utah</option>
    <option value="VT">Vermont</option>
    <option value="VA">Virginia</option>
    <option value="WA">Washington</option>
    <option value="WV">West Virginia</option>
    <option value="WI">Wisconsin</option>
    <option value="WY">Wyoming</option>
</select>
<br>
<br>

<label for="pwsName">PWS Name</label>
<br>
<input type="text" id="pwsName">
<br>
<br>

<label for="contaminants">Search by Contaminant</label>
<br>
<select id="contaminants">
    <option value="contaminantsDisabled"></option>
    <option value="4:2 FTS">4:2 FTS</option>
    <option value="6:2 FTS">6:2 FTS</option>
    <option value="8:2 FTS">8:2 FTS</option>
    <option value="9CI-PF3ONS">9CI-PF3ONS</option>
    <option value="11CI-PF3OUdS">11CI-PF3OUdS</option>
    <option value="ADONA">ADONA</option>
    <option value="HFPO-DA">HFPO-DA</option>
    <option value="lithium">lithium</option>
    <option value="NEtFOSAA">NEtFOSAA</option>
    <option value="NFDHA">NFDHA</option>
    <option value="NMeFOSAA">NMeFOSAA</option>
    <option value="PFBA">PFBA</option>
    <option value="PFDA">PFDA</option>
    <option value="PFDOA">PFDOA</option>
    <option value="PFEESA">PFEESA</option>
    <option value="PFHPA">PFHPA</option>
    <option value="PFHpS">PFHpS</option>
    <option value="PEHXA">PEHXA</option>
    <option value="PFHXS">PFHXS</option>
    <option value="PFMBA">PFMBA</option>
    <option value="PFMPA">PFMPA</option>
    <option value="PFNA">PFNA</option>
    <option value="PFOA">PFOA</option>
    <option value="PFOS">PFOS</option>
    <option value="PFPeA">PFPeA</option>
    <option value="PFPeS">PFPeS</option>
    <option value="PFTA">PFTA</option>
    <option value="PFTrDA">PFTrDA</option>
    <option value="PFUnA">PFUnA</option>
</select>
<br>

<p>Results above reference level</p>
<input type="checkbox" id="referenceLevelCheckbox">
<br>
<br>


<button id="submitBtn" style="background-color: #2c6d2c; color: white; border: none; padding: 5px 9px; text-align: center; text-decoration: none; display: inline-block; font-size: 10px; margin: 4px 2px; cursor: pointer; border-radius: 10px;">Submit</button>
<br>
<br>
<br>


<!-- New button "Contaminant Lookup" -->
<button id="lookupBtn" style="background-color: #242524; color: white; border: none; padding: 5px 9px; text-align: center; text-decoration: none; display: inline-block; font-size: 10px; margin: 4px 2px; cursor: pointer; border-radius: 10px;">Contaminant Lookup</button>


<p style="font-style: italic;">
  Data is sourced from the 
  <a href="https://www.epa.gov/dwucmr/fifth-unregulated-contaminant-monitoring-rule-data-finder">EPA UCMR 5 Data Finder</a>
</p>


<p style="font-style: italic;">μg/L x 1,000 = ppt</p>


<p id="results"></p>

<!-- The Modal -->
<div id="myModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <p>First select a state from the drop-down menu</p>
  </div>
</div>

<script>

document.addEventListener('DOMContentLoaded', function () {
    // Toggle questions and answers
    const questions = document.querySelectorAll('.question');
    questions.forEach(function (question) {
        question.addEventListener('click', function () {
            const answer = question.nextElementSibling;
            if (answer && answer.classList.contains('answer')) {
                answer.style.display = (answer.style.display === 'none' || answer.style.display === '') ? 'block' : 'none';
            }
        });
    });

    // Modal functionality
    var modal = document.getElementById("myModal");
    var span = document.getElementsByClassName("close")[0];

    span.onclick = function() {
        modal.style.display = "none";
    }

    window.onclick = function(event) {
        if (event.target == modal) {
            modal.style.display = "none";
        }
    }

    document.getElementById('submitBtn').addEventListener('click', function() {
        var pwsName = document.getElementById('pwsName').value.trim().toLowerCase();
        var state = document.getElementById('state').value;
        var contaminant = document.getElementById('contaminants').value;
        var filterAboveReferenceLevel = document.getElementById('referenceLevelCheckbox').checked;

        if (state === 'stateDisabled' || state === '') {
            modal.style.display = "block";
            return; // Prevent further execution
        }

        var urls = {
            'AL': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/alabamaUCMR5.csv',
            'AK': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/alaskaUCMR5.csv',
            'AZ': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/arizonaUCMR5.csv',
            'AR': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/arkansasUCMR5.csv',
            'CA': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/californiaUCMR5.csv',
            'CO': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/coloradoUCMR5.csv',
            'CT': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/connecticutUCMR5.csv',
            'DE': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/delawareUCMR5.csv',
            'FL': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/floridaUCMR5.csv',
            'GA': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/georgiaUCMR5.csv',
            'HI': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/hawaiiUCMR5.csv',
            'ID': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/idahoUCMR5.csv',
            'IL': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/illinoisUCMR5.csv',
            'IN': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/indianaUCMR5.csv',
            'IA': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/iowaUCMR5.csv',
            'KS': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/kansasUCMR5.csv',
            'KY': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/kentuckyUCMR5.csv',
            'LA': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/louisianaUCMR5.csv',
            'ME': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/maineUCMR5.csv',
            'MD': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/marylandUCMR5.csv',
            'MA': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/massachusettsUCMR5.csv',
            'MI': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/michiganUCMR5.csv',
            'MN': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/minnesotaUCMR5.csv',
            'MS': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/missisippiUCMR5.csv',
            'MO': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/missouriUCMR5.csv',
            'MT': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/montanaUCMR5.csv',
            'NE': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/nebraskaUCMR5.csv',
            'NV': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/nevadaUCMR5.csv',
            'NH': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/newhampshireUCMR5.csv',
            'NJ': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/newjerseyUCMR5.csv',
            'NM': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/newmexicoUCMR5.csv',
            'NY': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/newyorkUCMR5.csv',
            'NC': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/northcarolinaUCMR5.csv',
            'ND': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/northdakotaUCMR5.csv',
            'OH': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/ohioUCMR5.csv',
            'OK': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/oklahomaUCMR5.csv',
            'OR': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/oregonUCMR5.csv',
            'PA': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/pennsylvaniaUCMR5.csv',
            'RI': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/rhodeislandUCMR5.csv',
            'SC': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/southcarolinaUCMR5.csv',
            'SD': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/southdakotaUCMR5.csv',
            'TN': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/tennesseeUCMR5.csv',
            'TX': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/texasUCMR5.csv',
            'UT': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/utahUCMR5.csv',
            'VT': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/vermontUCMR5.csv',
            'VA': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/virginiaUCMR5.csv',
            'WA': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/washingtonUCMR5.csv',
            'WV': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/westvirginiaUCMR5.csv',
            'WI': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/wisconsinUCMR5.csv',
            'WY': 'https://raw.githubusercontent.com/KaiKai7/UCMR5/main/wyomingUCMR5.csv'
        };

        var url = urls[state];

        Papa.parse(url, {
            download: true,
            header: true,
            complete: function(results) {
                var data = results.data;
                var filteredResults = data.filter(function(row) {
                    var matchesPwsName = pwsName === '' || (row['PWS Name'] && row['PWS Name'].toLowerCase().includes(pwsName));
                    var matchesContaminant = contaminant === 'contaminantsDisabled' || contaminant === '' || row['Contaminant'] === contaminant;

                    var referenceConcentration = row['Result (µg/L)'];
                    var matchesReferenceLevel = !filterAboveReferenceLevel || (referenceConcentration && referenceConcentration !== "< MRL");

                    return matchesPwsName && matchesContaminant && matchesReferenceLevel;
                });

                if (filteredResults.length === 0) {
                    document.getElementById('results').innerText = 'No results found.';
                } else {
                    // Create table
                    var html = '<table border="1"><tr>';
                    // Create table headers dynamically
                    var keys = Object.keys(filteredResults[0]);
                    keys.forEach(function(key) {
                        html += '<th>' + key + '</th>';
                    });
                    html += '</tr>';
                    // Create table rows dynamically
                    filteredResults.forEach(function(row) {
                        html += '<tr>';
                        keys.forEach(function(key) {
                            html += '<td>' + (row[key] || 'N/A') + '</td>';
                        });
                        html += '</tr>';
                    });
                    html += '</table>';
                    document.getElementById('results').innerHTML = html;
                }
            }
        });
    });

    // Theme toggle functionality
    document.getElementById('theme-toggle').addEventListener('click', function() {
        document.body.classList.toggle('dark-theme');
        document.body.classList.toggle('light-theme');
    });
    
    // Set initial theme based on system preference
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark-theme');
    } else {
        document.body.classList.add('light-theme');
    }
    
    // JavaScript for opening the Contaminant Lookup URL
document.getElementById("lookupBtn").addEventListener("click", function() {
    window.open("contaminantLookup.html", "_blank");
});
}); 
</script>

<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="calibluesea" data-description="Support me on Buy me a coffee!" data-message="" data-color="#5F7FFF" data-position="Right" data-x_margin="18" data-y_margin="18"></script>

</body>
</html>
